(function(a){a.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()};a.fn.lionbars=function(b){function R(c){var j=a(c);if(w||v){j.find(".lb-wrap").scroll(function(c){j.find(".lb-v-scrollbar-slider").css({top:-a(this).scrollTop()/j.attr("vratio")});j.find(".lb-h-scrollbar-slider").css({left:-a(this).scrollLeft()/j.attr("hratio")});if(j.find(".lb-v-scrollbar").height()==parseInt(j.find(".lb-v-scrollbar-slider").css("top"))+j.find(".lb-v-scrollbar-slider").height()&&typeof b.reachedBottom=="function"&&!p){p=true;var d=a(this);b.reachedBottom.apply(a(this).children(".lb-content"),[function(){fb(a(d).parent(),{height:a(d).children(".lb-content").get(0).scrollHeight,width:a(d).children(".lb-content").get(0).scrollWidth});V(a(d).parent());T(a(d).parent());S(a(d).parent());U();p=false}])}if(j.find(".lb-h-scrollbar").width()==parseInt(j.find(".lb-h-scrollbar-slider").css("left"))+j.find(".lb-h-scrollbar-slider").width()&&typeof b.reachedRight=="function"&&!q){q=true;var d=a(this);b.reachedRight.apply(a(this).children(".lb-content"),[function(){fb(a(d).parent(),{height:a(d).children(".lb-content").get(0).scrollHeight,width:a(d).children(".lb-content").get(0).scrollWidth});V(a(d).parent());T(a(d).parent());S(a(d).parent());U();q=false}])}})}if(w){j.find(".lb-v-scrollbar-slider").mousedown(function(b){i=b.pageY;e=true;f=a(this);g=j.find(".lb-wrap");l=g.parent().attr("vratio");m=f.position().top;return false});j.find(".lb-v-scrollbar").mousedown(function(b){if(!a(b.target).hasClass("lb-v-scrollbar-slider")){j.find(".lb-wrap").scrollTop((b.pageY-a(this).offset().top)*Math.abs(j.attr("vratio"))-a(this).find(".lb-v-scrollbar-slider").height()/2)}return false})}if(v){j.find(".lb-h-scrollbar-slider").mousedown(function(b){h=b.pageX;d=true;f=a(this);g=j.find(".lb-wrap");l=g.parent().attr("hratio");m=f.position().left;return false});j.find(".lb-h-scrollbar").mousedown(function(b){if(!a(b.target).hasClass("lb-h-scrollbar-slider")){j.find(".lb-wrap").scrollLeft((b.pageX-a(this).offset().left)*Math.abs(j.attr("hratio"))-a(this).find(".lb-h-scrollbar-slider").width()/2)}return false})}if((w||v)&&autohide){j.find(".lb-v-scrollbar, .lb-h-scrollbar").hide();j.hover(function(){j.find(".lb-v-scrollbar, .lb-h-scrollbar").fadeIn(150)},function(){j.find(".lb-v-scrollbar, .lb-h-scrollbar").fadeOut(150)})}}function S(b){L=(I-a(b).find(".lb-wrap").get(0).scrollHeight-B-D)/(P-N);M=(H-a(b).find(".lb-wrap").get(0).scrollWidth-E-C)/(Q-O);var c=a(b);c.attr("vratio",L);c.attr("hratio",M)}function T(b){var c=a(b);var d,e,f;if(c.find(".lb-v-scrollbar").length!=0){d=20;f=I-c.find(".lb-v-scrollbar").height();e=I-f-d;N=Math.round(I*e/F);N=N<d?d:N}if(c.find(".lb-h-scrollbar").length!=0){d=20;f=H-c.find(".lb-h-scrollbar").width();e=H-f-d;O=Math.round(H*e/G);O=O<d?d:O}c.find(".lb-v-scrollbar-slider").css({height:N});c.find(".lb-h-scrollbar-slider").css({width:O})}function U(){t=0;u=0;v=false;w=false;x=0;y=0;z=0;A=0;B=0;E=0;D=0;C=0;F=0;G=0;H=0;I=0;J=0;K=0;N=0;O=0;P=0;Q=0}function V(b){var c=a(b);if(w&&v){P=c.height()-12;Q=c.width()-12;c.find(".lb-v-scrollbar").css({height:P});c.find(".lb-h-scrollbar").css({width:Q})}else{P=c.height()-4;Q=c.width()-4;c.find(".lb-v-scrollbar").css({height:P});c.find(".lb-h-scrollbar").css({width:Q})}}function W(b,c,d){var e=a(b);if(c||d){e.css({overflow:"hidden"});Y(e,e.find(".lb-wrap"));X(e);Z(e,e.find(".lb-wrap"))}}function X(b){var c=a(b);c.css({width:c.width()+y+A,height:c.height()+x+z})}function Y(b,c){var d=a(b);var e=a(c);d.css({padding:0});e.css({"padding-top":x+"px","padding-left":y+"px","padding-bottom":z+"px","padding-right":A+"px"})}function Z(b,c){var d=a(b);var e=a(c);d.css({position:"relative"});e.css({width:d.width()+t-y-A,height:d.height()+u-x-z})}function _(b){var c=a(b);c.css({overflow:"auto"});t=H-J-E-C;c.css({overflow:"hidden"})}function ab(b){var c=a(b);c.css({overflow:"auto"});u=I-K-B-D;c.css({overflow:"hidden"})}function bb(b,c,d){var e=a(b);var f=e.attr("id");var g=0;if(f!==undefined){e.wrapInner('<div class="lb-wrap" id="lb-wrap-'+s+"-"+f+'"></div>');g=a("#lb-wrap-"+s+"-"+f)}else{e.wrapInner('<div class="lb-wrap" id="lb-wrap-'+s+'"></div>');g=a("#lb-wrap-"+s)}g.wrapInner('<div class="lb-content"></div>');if(c){e.prepend('<div class="lb-v-scrollbar"></div>');e.find(".lb-v-scrollbar").append('<div class="lb-v-scrollbar-slider"></div>')}if(d){e.prepend('<div class="lb-h-scrollbar"></div>');e.find(".lb-h-scrollbar").append('<div class="lb-h-scrollbar-slider"></div>')}s=s+1}function cb(b){var c=a(b);w=false;v=false;db(c);eb(c);c.css({overflow:"hidden"});if(c.get(0).scrollHeight>c.get(0).clientHeight){w=true}if(c.get(0).scrollWidth>c.get(0).clientWidth){v=true}c.css({overflow:"auto"});if(w||v){return true}}function db(b){var c=a(b);x=parseInt(c.css("padding-top"),10)||0;y=parseInt(c.css("padding-left"),10)||0;z=parseInt(c.css("padding-bottom"),10)||0;A=parseInt(c.css("padding-right"),10)||0}function eb(b){var c=a(b);B=parseInt(c.css("border-top-width"),10)||0;C=parseInt(c.css("border-right-width"),10)||0;D=parseInt(c.css("border-bottom-width"),10)||0;E=parseInt(c.css("border-left-width"),10)||0}function fb(b,c,d){var e=a(b).get(0);if(d){e=a(e).find(".lb-wrap").get(0)}F=typeof c!="undefined"&&c!=false?c.height:e.scrollHeight;G=typeof c!="undefined"&&c!=false?c.width:e.scrollWidth;K=e.clientHeight;J=e.clientWidth;I=e.offsetHeight;H=e.offsetWidth;_(a(b));ab(a(b))}b=b||{};autohide=b.autohide;var c,d=false,e=false,f=0,g=0,h,i,j,k,l,m,n,o=false,p=false,q=false;var r=a(this),s=0,t=0,u=0,v=false,w=false,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0;this.mainLoop=function(){for(var b=0;r[b]!==undefined;b++){if(cb(r[b])&&!a(r[b]).hasClass("nolionbars")){target=r[b];fb(target);bb(target,w,v);W(target,w,v);V(target);T(target);S(target);R(target);U()}}};this.mainLoop();this.Update=function(){for(var b=0;r[b]!==undefined;b++){if(cb(r[b])&&!a(r[b]).hasClass("nolionbars")){target=r[b];fb(target,false,true);W(target,w,v);V(target);T(target);S(target);R(target);U()}}};this.scrollToBottom=function(){for(var b=0;r[b]!==undefined;b++){if(cb(r[b])&&!a(r[b]).hasClass("nolionbars")){target=r[b];fb(target,false,true);var c=a(target).find(".lb-wrap");var d=c.parent().attr("vratio");var e=(F-K)*Math.abs(d);c.scrollTop(e)}}};a(document).mousemove(function(a){if(e){k=a.pageY;g.scrollTop((m+k-i)*Math.abs(l))}if(d){j=a.pageX;g.scrollLeft((m+j-h)*Math.abs(l))}});a(document).mouseup(function(a){if(e){e=false}if(d){d=false}});return this.each(function(){})}})(jQuery)